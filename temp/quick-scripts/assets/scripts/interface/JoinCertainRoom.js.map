{"version":3,"sources":["JoinCertainRoom.js"],"names":["GLB","require","engine","msg","cc","Class","extends","Component","properties","match","Node","back","nickName","Label","roomID","default","type","EditBox","errorHint","onLoad","self","initEvent","string","userID","on","EventType","TOUCH_END","director","loadScene","roomidTmp","result","prototype","joinRoom","node","active","systemEvent","MATCHVS_ERROE_MSG","onEvent","MATCHVS_JOIN_ROOM_RSP","MATCHVS_NETWORK_STATE_NOTIFY","event","eventData","data","errorCode","console","warn","netNotify","state","log","removeEvent","off","onDestroy"],"mappings":"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","file":"JoinCertainRoom.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\interface","sourcesContent":["let GLB = require(\"Glb\");\nlet engine = require(\"../MatchvsLib/MatchvsDemoEngine\");\nlet msg = require(\"../MatchvsLib/MatvhvsMessage\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        match: cc.Node,\n        back: cc.Node,\n        nickName:cc.Label,\n        roomID: {\n            default: null,\n            type: cc.EditBox\n        },\n        errorHint: {\n            default: null,\n            type: cc.Label\n        }\n    },\n\n\n    onLoad () {\n        let self = this;\n        this.initEvent();\n        self.nickName.string = '用户ID:'+GLB.userID;\n        this.back.on(cc.Node.EventType.TOUCH_END, function(){\n            cc.director.loadScene(\"Lobby\");\n        });\n        this.match.on(cc.Node.EventType.TOUCH_END, function(){\n            let roomidTmp = self.roomID.string;\n            if (roomidTmp !== null && roomidTmp !== \"\") {\n                let result = engine.prototype.joinRoom(roomidTmp, \"Matchvs\");\n                if (result === 0) {\n                    self.errorHint.node.active = false;\n                } else {\n                    self.errorHint.node.active = true;\n                    self.errorHint.string = \"没有查找到此房间，请重新输入\"\n                }\n            } else {\n                self.errorHint.node.active = true;\n                self.errorHint.string = \"房间号不能为空，请输入房间号在进行加入\"\n            }\n        });\n    },\n\n    /**\n     * 注册对应的事件监听和把自己的原型传递进入，用于发送事件使用\n     */\n    initEvent:function () {\n        cc.systemEvent.on(msg.MATCHVS_ERROE_MSG,this.onEvent,this);\n        cc.systemEvent.on(msg.MATCHVS_JOIN_ROOM_RSP,this.onEvent,this);\n        cc.systemEvent.on(msg.MATCHVS_NETWORK_STATE_NOTIFY,this.onEvent,this);\n    },\n\n\n    /**\n     * 接收事件\n     * @param event\n     */\n    onEvent:function (event) {\n        let eventData = event.data;\n        if (event.type === msg.MATCHVS_ERROE_MSG) {\n            if (eventData.errorCode === 405 ) {\n                this.errorHint.node.active = true;\n                this.errorHint.string = \"房间已满\";\n                console.warn(\"房间已满\");\n                return;\n            }\n            if (eventData.errorCode === 406) {\n                this.errorHint.node.active = true;\n                this.errorHint.string = \"房间已经关闭\";\n                console.warn(\"房间已joinOver\");\n                return;\n            }\n            cc.director.loadScene('Login');\n        } else if (event.type === msg.MATCHVS_JOIN_ROOM_RSP) {\n            GLB.roomID = this.roomID.string;\n            cc.director.loadScene(\"CreateRoom\");\n        } else if (event.type === msg.MATCHVS_NETWORK_STATE_NOTIFY) {\n            if (eventData.netNotify.userID === GLB.userID && eventData.netNotify.state === 1) {\n                console.log(\"netNotify.userID :\"+eventData.netNotify.userID +\"netNotify.state: \"+eventData.netNotify.state);\n                cc.director.loadScene(\"Login\");\n            }\n        }\n    },\n\n    /**\n     * 移除监听\n     */\n    removeEvent:function () {\n        cc.systemEvent.off(msg.MATCHVS_ERROE_MSG,this.onEvent);\n        cc.systemEvent.off(msg.MATCHVS_JOIN_ROOM_RSP,this.onEvent);\n        cc.systemEvent.off(msg.MATCHVS_NETWORK_STATE_NOTIFY,this.onEvent);\n    },\n\n\n    \n    onDestroy:function () {\n        this.removeEvent();\n        console.log(\"join certain Room 页面销毁\");\n    },\n\n});\n"]}